- breadcrumb :payments
= link_to t('shared.add_new_item'), new_payment_path, class: 'btn btn-default'
.payments
  %table.table.table-condensed
    %thead
      %tr
        %th= t('payment.columns.student')
        %th= t('payment.columns.paid')
        %th{colspan: 3}= t('payment.columns.list')
    %tbody
      - students.order(:last_name).each do |student|
        %tr
          - rowspan = student.payments.length == 0 ? 1 : student.payments.length
          %td{rowspan: rowspan}= student.decorate.full_name
          %td{rowspan: rowspan, class: 'paid'}
            - if student.decorate.paid_tuition_for_current_month?
              = fa_icon "check"
            - else
              = fa_icon "times"
          - if student.payments.order(:date)[0]
            = render student.payments.order(:date)[0]
          - else
            %td
            %td
            %td
        - student.payments.order(:date).each_with_index do |payment, index|
          - unless index == 0
            %tr= render payment